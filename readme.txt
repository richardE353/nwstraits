Last updated: 2024-05-04

This codebase has the following required packages:

    Package     |  Pip Installation command  | Install Info
    ------------+---------------------------+----------------
    pandas      |   pip install pandas      | https://pandas.pydata.org/docs/getting_started/install.html
    openpyxl    |   pip install openpyxl    | https://openpyxl.readthedocs.io/en/stable/tutorial.html?highlight=installation#installation
    requests    |   pip install requests    | https://docs.python-requests.org/en/latest/user/install/


Default runtime arguments, and the correct SmugMug API key should be set in the RuntimeArgs.py file.

There are currently 3 different programs.  They are as follows:

anchoring.py
    This program takes the attachments downloaded from KoboToolbox, and renames them and puts them into the export
    directory you specify when running the program.   It should be used for anchoring surveys.

    *** NOTE *** Be sure to select "XML values and headers" for the Value and header format for the XLS export

    Filenames are standardized to have the following prefix for each survey processed:
        county_location_surveyDate_databaseRowIndex

    The Anchoring Survey export structure is as follows:
        extractionLog.txt
            summary file listing the following info
                runtime parameters
                surveys organized by county
                survey volunteers
    Running the program

    Presuming your computer has python3 installed, and you are in the kobo directory, run the program as follows:
        Mac/Linux
            python3 anchoring.py

    Once the program is running, you must answer the following questions:

        Enter collection year (2022 or later):
        Enter .xlsx file to read:
        Enter starting submission date (yyyy-mm-dd) (blank = process all data):
        Enter directory containing attachments:
        Output directory:

    The results will be in the output directory.  Error handling is minimal.  If a directory or file is incorrect,
    you will get an exception.

kelp.py
    This program takes the attachments downloaded from KoboToolbox, and renames them and puts them into the export
    directory you specify when running the program.  It should be used for kelp surveys.

    *** NOTE *** Be sure to select "XML values and headers" for the Value and header format for the XLS export

    Filenames are standardized to have the following prefix for each survey processed:
        county_location_surveyDate_databaseRowIndex

        ex: clallam_clallam_bay_2020_07_23_35_Gps1.gpx

    The Kelp Survey export structure is as follows:
        extractionLog.txt
            summary file listing the following info
                runtime parameters
                surveys missing data sheets
                surveys missing GPX files
                surveys missing depth data
                surveys missing temperature data
                surveys missing tidal corrections
                surveys containing kelp cluster info
                surveys organized by county
                survey volunteers

        gisWorksheet.xlsx - file containing key fields and images for easy import into GIS tools

        to_beach_album - directory containing all "to_beach" images renamed for upload to SmugMug

        {countyName}
            data_files
                contains datasheet images, .gpx files, and user defined spreadsheets (.csv or .xlsx)
            site_photos
                photos of the kelp site
            volunteer_photos
                photos of volunteers

    Running the program

    Presuming your computer has python3 installed, and you are in the kobo directory, run the program as follows:
        Mac/Linux
            python3 kelp.py

    Once the program is running, you must answer the following questions:

        Enter collection year (2022 or later):
        Enter .xlsx file to read:
        Enter starting submission date (yyyy-mm-dd) (blank = process all data):
        Enter directory containing attachments:
        Output directory:

    The results will be in the output directory.  Error handling is minimal.  If a directory or file is incorrect,
    you will get an exception.

smugmug.py
    ***NOTE*** you must get correct API Key from SmugMug and update RuntimeArgs.py!!!

    Running this program will find all beach images for the specified year on SmugMug, and update the associated GISWorkseet row 'ToBe' (to beach) cell with the SmugMug URL for the XL image.  It will then overwrite the gisWorksheet.xlsx file that was generated by KelpData.py.

    Once the program is running, you must answer the following questions:
        Enter collection year (2022 or later):
        GISWorksheet directory:

